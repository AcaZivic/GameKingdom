var prefiksJSON="assets/data/",prefiksPage="pages/",prefiksDok="assets/doc/",prefiksSlike="assets/images/",prefiksPomocno="",prefiksOnline="/GameKingdom/";const bodyTag=document.getElementsByTagName("body"),strelicaObj=document.querySelector("#strelicaPocetak"),navigacijaLink=document.querySelector("#navigacija");var animacija=setInterval(slajderAnimacija,4e3),funkExp=function(){},nizProizvoda=[],nizProizvodjaca=[],nizPlatformi=[],nizPegiOznaka=[],nizZanrova=[],nizPromocije=[],nizCboxa=[],nizNavigacija=[],nizSlider=[];const footerLink=document.querySelector("footer .row.py-3 > div"),footerInfo=document.querySelector("footer ul#contact"),footerInfoObj=[{id:1,icon:"phone",txt:"&nbsp;&nbsp;063/710-5150"},{id:2,icon:"envelope",txt:"&nbsp;&nbsp;aleksandar&#46;zivic&#46;7&#46;21&#64;ict&#46;edu&#46;rs"},{id:2,icon:"map-marker-alt",txt:`&nbsp;&nbsp;Zdravka Čelara 16, Belgrade`}],footerIcons=document.querySelector("footer ul.d-flex");function dohvatiPodatkePromise(a){return new Promise((e,i)=>{$.ajax({url:prefiksOnline+prefiksJSON+a,method:"get",dataType:"json",success:function(a){e(a)},error:function(a,e){var i="",n="";let r=new Date;0===a.status?(n="Niste konektovani na internet.",i="Proverite Vašu internet konekciju"):404==a.status?(n="Traženi dokument je nedostupan (404)",i="Proverite naziv dokumenta koji tražite"):500==a.status?(n="Greška na serveru (500).",i="Molimo sačekajte dok se problem ne reši"):"parsererror"===e?(n="Parsiranje traženog JSON fajla nije uspelo.",i="Javite se kontakt podršci !"):"timeout"===e?(n="Greška prekid na mreži zbog dugog čekanja.",i="Javite se Vašem internet provajderu !"):"abort"===e?(n="Ajax zahtev je obustavljen.",i="Javite se kontakt podršci !"):(n="Greška !!!\n"+a.responseText,i="Javite se kontakt podršci !");let t=document.querySelector("#greskaModal");t.querySelector("small").innerHTML=`${r.getDate()}.${r.getMonth()+1}.${r.getFullYear()}.`,t.querySelector(".modal-header p").innerHTML="Greška "+a.status,t.querySelector(".modal-header h5").innerHTML=n,t.querySelector(".modal-body p").innerHTML=i,crtanjeModala(document.querySelector("#greskaModal"))}})})}let url=window.location.pathname;function proveraFormeUzivo(a){let e=document.querySelector("select");var i=document.querySelector(".form-floating.col-md-12 > .row");e.addEventListener("change",function(){let a=Number(e.value);a?(e.previousElementSibling.classList.remove("text-danger"),e.previousElementSibling.classList.add("text-success"),e.classList.remove("az-form-border"),2==a?(i.innerHTML=` <div class="form-floating col-md-12">
                    <input type="text" class="form-control" id="inputAdresa" placeholder="Partizanska 27"/>
                    <label for="inputAdresa" class="form-label ps-3">Adresa: <span class="text-danger"><i class="fa-regular fa-asterisk"></i></span></label>
                    <p class="az-red mt-2 mb-0 ms-1 az-invisible fw-bold"></p>
                </div><div class="form-floating col-md-12 mt-3">
                <input type="text" class="form-control" id="inputGrad" placeholder="Beograd"/>
                <label for="inputGrad" class="form-label ps-3">Grad: <span class="text-danger"><i class="fa-regular fa-asterisk"></i></span></label>
                <p class="az-red mt-2 mb-0 ms-1 az-invisible fw-bold"></p>
            </div>`,i.classList.remove("az-invisible")):(i.innerHTML="",i.classList.remove("az-invisible"))):(e.previousElementSibling.classList.add("text-danger"),e.previousElementSibling.classList.remove("text-success"),e.classList.add("az-form-border"),i.classList.add("az-invisible"))}),a.forEach(function(a){a.addEventListener("keyup",function(){a.value.length?(a.classList.remove("az-form-border"),a.nextElementSibling.nextElementSibling.classList.add("az-invisible"),proveriElem(a)):(bool=!1,a.classList.add("az-form-border"),a.nextElementSibling.nextElementSibling.innerHTML="Niste popunili polje",a.nextElementSibling.nextElementSibling.classList.remove("az-invisible"))})})}function zavrsiLoadScreen(){$("#load-screen").addClass("az-anim-opac"),$(bodyTag).addClass("az-body-visi"),setTimeout(function(){$("#load-screen").addClass("az-load-del")},1150)}function prikazNavigacije(a){let e="";for(indeks in a){if(3==indeks){e+=`<li class='nav-item me-1'>
                        <a class='nav-link fs-5 px-3 py-2 position-relative' href=${prefiksOnline+a[indeks].href}>
                            <i class="fa-solid fa-cart-shopping"></i>
                            <span class="az-cart-number">0</span>
                        </a>
                    
                  </li>`;continue}e+="<li class='nav-item me-1'>",e+=`<a class='hover-underline-animation nav-link fs-6 px-3 py-2' href="${prefiksOnline+a[indeks].href}">${a[indeks].name}</a>`,e+="</li>"}navigacijaLink.innerHTML=e}function glavniLink(a){navigacijaLink.querySelectorAll("li > a").forEach(function(e){e.getAttribute("href")==a&&e.classList.add("active")})}function strelicaPrikaz(){document.addEventListener("scroll",function(){window.scrollY>900?strelicaObj.classList.contains("postaviStrelicu")||(strelicaObj.classList.remove("skiniStrelicu"),strelicaObj.classList.add("postaviStrelicu"),strelicaObj.classList.add("d-flex")):strelicaObj.classList.contains("postaviStrelicu")&&(strelicaObj.classList.remove("postaviStrelicu"),strelicaObj.classList.add("skiniStrelicu"),setTimeout(()=>{strelicaObj.classList.remove("d-flex")},300))}),strelicaPocetak.addEventListener("click",function(){window.scrollTo(0,0)})}function procitajVise(a){a.each((a,e)=>$(e).click(function(){$(this).prev().slideToggle(600),"Pročitaj više"==$(this).html()?$(this).html("Pročitaj manje"):$(this).html("Pročitaj više")}))}function prikazFooterLinkova(a){for(let e=0;e<2;e++)footerLink.innerHTML+=`<ul class="row my-3">
        <li class="col-6"><a href="${prefiksOnline+a[e].href}">${a[e].name}</a></li>
        <li class="col-6"><a href="${prefiksOnline+a[e+2].href}">${a[e+2].name}</a></li>
      </ul>`}function prikazFooterInformacija(){for(obj of footerInfoObj)footerInfo.innerHTML+=`<li class="my-3"><i class="fas fa-${obj.icon}"></i>${obj.txt}</li>`}function prikazFooterIkonica(a){for(var e=3;e<a.length;e++)a[e].link=prefiksOnline+a[e].link;for(element of a)footerIcons.innerHTML+=`<li><a class="az-sm d-flex justify-content-center align-items-center rounded-circle" href="${element.link}"><i class="az-white ${element.icon}"></i></a> </li>`}function prikazForme(a,e){for(let i=0;i<a.length;i++)a[i].addEventListener("focus",function(){e[i].innerHTML+=`  (Primer: ${a[i].getAttribute("placeholder")})`}),a[i].addEventListener("blur",function(){e[i].innerHTML=e[i].getAttribute("for").substring(5)+'<span class="text-danger"><i class="fa-regular fa-asterisk"></i></span>'})}function proveraForme(){var a=!0;let e=this.parentElement.parentElement.querySelectorAll("input[type='text'],input[type='email']"),i=document.querySelector("select"),n=document.kontaktForm.tipKontakt;e.forEach((e,i)=>{e.value.length?proveriElem(e)||(a=!1):(a=!1,e.classList.add("az-form-border"),e.nextElementSibling.nextElementSibling.innerHTML="Niste popunili polje",e.nextElementSibling.nextElementSibling.classList.remove("az-invisible"))}),i.selectedIndex?i.classList.remove("az-form-border"):(a=!1,i.classList.add("az-form-border")),n.value?n[0].parentElement.parentElement.nextElementSibling.classList.add("az-invisible"):(n[0].parentElement.parentElement.nextElementSibling.classList.remove("az-invisible"),a=!1),a?(this.parentElement.parentElement.innerHTML=`<p class="fs-3 fw-bold text-success">Uspešno ste poručili artikle</p>`,setTimeout(function(){let a=$("#poruciModal");a.animate({opacity:"0"},300),setTimeout(function(){$(a).removeClass("az-visible")},300),$("#pozadinaModal").remove(),localStorage.clear(),prikazPraznuKorpu()},2e3)):(this.previousElementSibling.classList.add("az-red"),this.previousElementSibling.classList.remove("text-success"),this.previousElementSibling.innerHTML="Niste dobro popunili formu !"),this.previousElementSibling.classList.remove("az-invisible")}function proveriElem(a){let e=!0;return a.id.match(/input(?=(Ime|Prezime|Grad))/)&&(e=/^([A-ZČĆŽŠĐ][a-zčćžšđ]{2,})(\s[A-ZČĆŽŠĐ][a-zčćžšđ]{2,})*$/.test(a.value),a.parentElement.lastElementChild.innerHTML="Niste popunili polje u formatu (prvo veliko ostala mala slova)"),("inputEmail"==a.id||"emailUnos"==a.id)&&(e=/^[\w\_]{3,}\@[a-z]{3,}\.[a-z]{2,3}$/.test(a.value),a.parentElement.lastElementChild.innerHTML="Niste popunili polje u formatu (primer@gmail.com)"),"inputTelefon"==a.id&&(e=/^(06[^7]\/[0-9]{7})|(067\/7[0-9]{6})$/.test(a.value)),"inputAdresa"==a.id&&(e=/^(((\d{2,4}\.?)((\s(([a-zčćžšđ]{3,}))+))+))|(([A-ZČĆŽŠĐ][a-zčćžšđ]{2,})(\s(\w+))*)$/.test(a.value),a.parentElement.lastElementChild.innerHTML="Niste popunili polje u formatu (npr. Partizanska 27 ili 1000 kaplara)"),e?(a.classList.remove("az-form-border"),a.parentElement.lastElementChild.classList.add("az-invisible")):(a.classList.add("az-form-border"),a.parentElement.lastElementChild.classList.remove("az-invisible")),e}function prikazInput(a){document.querySelector(".form-floating.col-md-12 > .row").innerHTML=""}function padajuciMeni(){$("#btnMeni").click(function(){$(this).next().slideToggle()})}url="/GameKingdom/"==url?"/GameKingdom/index.html":url,window.onload=async function(){if(url!=`${prefiksOnline}index.html`&&url!=`${prefiksOnline}`&&(prefiksPage=prefiksOnline+prefiksPage,prefiksSlike=prefiksOnline+prefiksSlike),await proizovodi(),prikazNavigacije(nizNavigacija=await dohvatiPodatkePromise("navigacija.json")),glavniLink(url),prikazFooterLinkova(nizNavigacija),padajuciMeni(),document.querySelector(".az-newsletter-btn").addEventListener("click",proveraNewsletter),prikaziBrojProizvodaUKorpi(),url==`${prefiksOnline}index.html`||url==`${prefiksOnline}`){prikazDugmica(nizSlider=await dohvatiPodatkePromise("slider.json"));let a=document.querySelector("#carouselSliderIndicators");slajderSlike(a,nizSlider);let e=$("button[data-az-slide]");slajderDugmici(e),prikazProizvoda(nizProizvoda.filter(a=>a.top),document.querySelector("#topProizvodi"));var i,n,r=document.querySelector(".az-akcije");prikazProizvodaOdabrani(nizProizvoda.filter(a=>null!=a.cenaInfo.promocija),r),prikazProizvoda(nizProizvoda.sort((a,e)=>{var i=new Date(a.datumIzlaska),n=new Date(e.datumIzlaska);return i.getTime()>n.getTime()?-1:1}).slice(0,4),document.querySelector("#najnovijiProizvodi")),dodavanjeKorpa()}if(url==`${prefiksOnline}pages/proizvodi.html`&&(prikazCheckBoxova(nizProizvoda),$("#cistac").click(ocistiFiltere),prikazProizvodaProdavnica(),$("#chbPart input[type='checkbox']").change(prikazProizvodaProdavnica),document.querySelector("#sortPro").addEventListener("change",prikazProizvodaProdavnica),document.querySelector("#inputNaziv").addEventListener("keyup",prikazProizvodaProdavnica),prikaziBrojProizvodaUKorpi()),url==`${prefiksOnline}pages/korpa.html`){prikaziBrojProizvodaUKorpi(),brArtikalaKorpa()?prikazKorpe(dohvatiLS("korpa")):prikazPraznuKorpu();let t=document.querySelector("#kontaktForm");proveraFormeUzivo(t.querySelectorAll("input[type='text'],input[type='email']"))}var o=await dohvatiPodatkePromise("futerLinkovi.json");prikazFooterInformacija(),prikazFooterIkonica(o),strelicaPrikaz(),setTimeout(zavrsiLoadScreen,1300),setTimeout(()=>$("#load-screen").remove(),2300)};let brAk=0;function slajderDugmici(a){a.each(function(e,i){let n=e;$(i).click(function(){clearInterval(animacija);var e=$("#carouselSliderIndicators .carousel-inner .az-visible"),i=$(e.parent().children()[n]);i.hasClass("az-visible")||(e.hide("slow").removeClass("az-visible"),i.fadeIn().addClass("az-visible")),brAk=n,$($(a).find("img")).attr("src",`${prefiksOnline+prefiksSlike}/controllerSlide.png`),$($(this).find("img")).attr("src",`${prefiksOnline+prefiksSlike}/controllerSlideActive.png`),$(a).removeClass("az-active"),$(this).addClass("az-active"),animacija=setInterval(slajderAnimacija,4e3)})})}function slajderAnimacija(){var a=$("#carouselSliderIndicators .carousel-inner .az-visible"),e=a.next().length?a.next():a.parent().children(":first");let i=$("#carouselSliderIndicators button").filter(`button[data-az-slide = ${brAk}]`),n=$(i).find("img"),r=i.next().length?i.next():i.parent().children(":first"),t=$(r).find("img");a.hide("slow").removeClass("az-visible"),e.fadeIn().addClass("az-visible"),brAk=brAk<3?++brAk:0,i.removeClass("az-active"),$(n).attr("src",`${prefiksOnline+prefiksSlike}/controllerSlide.png`),r.addClass("az-active"),$(t).attr("src",`${prefiksOnline+prefiksSlike}/controllerSlideActive.png`)}function crtanjeModala(a){$(a).addClass("az-visible"),$(a).animate({opacity:"1"},300),$('<div id="pozadinaModal" class="modal-backdrop fade show"></div>').appendTo($("body")),$($(a).find(".btn-close,.btn-secondary")).click(function(){let a=$(this).parent().parent().parent().parent();a.animate({opacity:"0"},300),setTimeout(function(){$(a).removeClass("az-visible")},300),$("#pozadinaModal").remove()}),$("#dugmeProvera").click(proveraForme)}function brisiPoruke(a){a.showErrors({inputIme:"",inputEmail:"",inputPrezime:"",txtOblast:"Morate ostaviti poruku koju prosleđujete!"})}function prikazImenaStrane(){document.querySelectorAll("#naslovna span").forEach(function(a){a.innerText=url.substring(url.lastIndexOf("/")+1,url.lastIndexOf(".")).toLowerCase()})}function slajderSlike(a,e){for(let i=0;i<e.length;i++){var n=document.createElement("div");n.classList.add("carousel-item"),i||n.classList.add("az-visible"),n.innerHTML=`<img src='${prefiksSlike+e[i].slika.src}' class="d-block w-100 mx-auto" alt="${e[i].slika.alt}"/>`,a.lastElementChild.appendChild(n)}}function prikazDugmica(a){var e=document.querySelector("#carouselSliderIndicators div");let i=`<button type="button"  data-az-slide="0" class="az-active me-2" >
                    <img src="${prefiksSlike}controllerSlideActive.png" />
                </button>`,n="";for(let r=1;r<a.length;r++)i+=`<button type="button"  data-az-slide="${r}" class="az-active ${n=r<a.length-1?"me-2":""}" >
                    <img src="${prefiksSlike}controllerSlide.png" />
                </button>`;e.innerHTML=i}function prikazProizvoda(a,e){let i="";for(var n of a)i+=`<div class="col-lg-3 col-sm-6 col-12 mb-5 az-opac-0">
                    <div class="card rounded-3 text-center">
                        <a class="az-btn-modal" data-id="${n.id}"><img class="card-img-top" src="${prefiksOnline+n.slika.src}" alt="${n.slika.alt}" /></a>
                        <div class="card-body">
                            <div class="az-head-h">
                                <a class="az-btn-modal" data-id="${n.id}"><h5 class="card-title fw-bold">${n.naziv}</h5></a>
                                <a href="${nizProizvodjaca.filter(a=>a.id==n.proizvodjac)[0].href}" target="_blank"><small class="text-primary fw-bold">${nizProizvodjaca.filter(a=>a.id==n.proizvodjac)[0].naziv}</small></a>
                            </div>
                            <hr class="az-hr w-50 my-3"/>
                            <p class="card-text">
                                ${null!=n.cenaInfo.cenaNova?`<span class="az-old-cena text-warning fw-bold ">${n.cenaInfo.cenaStara} RSD</span><br/><span class="az-new-cena fs-4">${n.cenaInfo.cenaNova} RSD</span> `:`<br/><span class="az-new-cena fs-4">${n.cenaInfo.cenaStara} RSD</span>`}
                            </p>
                        </div>
                        <button class="btn btn-warning w-100 az-btn-pro rounded-0 rounded-bottom fs-5 az-btn-korpa" data-id="${n.id}">Dodaj u korpu <i class="fa-solid fa-cart-shopping"></i></button>
                    </div>
                </div>`;e.innerHTML=i;prikazOpacity(Array.from(e.children)),prikazModalaArtikal()}function prikazOpacity(a){a.forEach((a,e)=>{setTimeout(function(){a.classList.add("az-opacity"),a.classList.remove("az-opac-0")},100*e)})}function prikazProizvodaOdabrani(a,e){var i=[];for(var n of(a.forEach(a=>{i.includes(a.cenaInfo.promocija)||i.push(a.cenaInfo.promocija)}),e.innerHTML="",i)){let r=nizPromocije.filter(a=>a.id==n)[0],t=`<div class="row flex-wrap">
        <div class="col-12 my-5 text-center">
            <h2 class="fs-1"><i class="fa-solid fa-percent text-warning"></i> ${r.naziv} <i class="fa-solid fa-percent text-warning"></i></h2>
            <hr class="az-hr"/>
        </div>
        <div class="col-12">
          <div id="${r.naziv.split(" ")[0]}Akcija" class="row">
            <div class="col-12">
              <div class="row my-5">
                <div class="col-xl-5 col-md-10 col-12 mx-auto">
                  <a>
                    <img class="img-fluid" src="${prefiksPomocno+r.slika.src}" alt="${r.slika.alt}" />
                  </a>
                </div>
                <div class="col-xl-7 col-md-10 col-12 mx-auto mt-xl-0 mt-5  text-center d-flex flex-column justify-content-center">
                    <p>${r.opis}</p>
                    <p class="fs-5 fw-bold">PONUDA VAŽI JOŠ</p>
                    <div class="row ">
                        <div class=" col-md-8 col-12 mx-auto">
                            <div class="row justify-content-center">
                                <div class="col-xxl-2 col-3">
                                    <span class="d-flex flex-column justify-content-center align-items-center">
                                        <span data-timername="dan" class="az-box-timer fw-bold">10</span>
                                        <span >Dani</span>
                                    </span>
                                </div>
                                <div class="col-xxl-2 col-3">
                                  <span class="d-flex flex-column justify-content-center align-items-center">
                                      <span data-timername="sat" class="az-box-timer fw-bold">10</span>
                                      <span >Sati</span>
                                  </span>
                              </div>
                              <div class="col-xxl-2 col-3">
                                <span class="d-flex flex-column justify-content-center align-items-center">
                                    <span data-timername="min" class="az-box-timer fw-bold">10</span>
                                    <span >Minuti</span>
                                </span>
                            </div>
                            <div class="col-xxl-2 col-3">
                              <span class="d-flex flex-column justify-content-center align-items-center">
                                  <span data-timername="sek" class="az-box-timer fw-bold">10</span>
                                  <span >Sekundi</span>
                              </span>
                          </div>
                            </div>
                        </div>
                    </div>
                </div>
              </div>
            </div> 
            <div id="odabraniProizvodi${r.naziv.split(" ")[0]}" class="col-lg-8 col-sm-12 col-10 mx-auto text-center">
                <div   class="row">
                </div>
            </div>
            </div>
            </div></div>`;e.innerHTML+=t;let o;timerAction(new Date(r.datumKraj),document.querySelectorAll(`#${r.naziv.split(" ")[0]}Akcija .az-box-timer`)),t='<h3 class="col-12 text-center">Odabrani proizvodi<br/><i class="fa-solid fa-arrow-down fs-1"></i></h3>';let l=[],s=[],c=e.querySelector(`#odabraniProizvodi${r.naziv.split(" ")[0]} .row`),d=a.filter(a=>a.cenaInfo.promocija==n);for(let p=0;p<4;p++){let u=Math.floor(Math.random()*d.length);if(l.includes(u)){if(p>=d.length)break;p--;continue}l.push(u),s.push(a[u])}prikazProizvoda(s,c),c.innerHTML=t+c.innerHTML,c.parentElement.innerHTML=c.parentElement.innerHTML+'<a href="pages/proizvodi.html" class="btn btn-warning az-w-btn mx-auto my-5 az-btn-pro rounded-0 rounded-bottom fs-5">Pogledaj celu ponudu <i class="fa-solid fa-arrow-right"></i></a>'}prikazOpacity(Array.from(e.querySelectorAll(".az-opac-0")))}function timerAction(a,e){let i=a-new Date;var n=Math.floor(i/864e5),r=Math.floor(i%864e5/36e5),t=Math.floor(i%36e5/6e4),o=Math.floor(i%6e4/1e3);e.forEach(a=>{let e=$(a).data("timername");"dan"==e?a.innerHTML=n:"sat"==e?a.innerHTML=r:"min"==e?a.innerHTML=t:"sek"==e&&(a.innerHTML=o)}),setTimeout(function(){timerAction(a,e)},1e3)}function proveraNewsletter(a){a.preventDefault(),proveriElem(document.querySelector("#emailUnos"))?(document.querySelector("#emailUnos").parentElement.lastElementChild.classList.remove("text-danger","az-invisible"),document.querySelector("#emailUnos").parentElement.lastElementChild.classList.add("text-success"),document.querySelector("#emailUnos").parentElement.lastElementChild.innerHTML="Uspesno ste se prijavili",setTimeout(function(){document.querySelector("#emailUnos").value="",document.querySelector("#emailUnos").parentElement.lastElementChild.classList.add("az-invisible"),document.querySelector("#emailUnos").parentElement.lastElementChild.classList.remove("text-success")},2e3)):document.querySelector("#emailUnos").parentElement.lastElementChild.classList.add("text-danger")}function sortiranjeProizvoda(a){var e=document.querySelector("#sortPro");return a.sort((a,i)=>{if("0"==e.value)return a.id-i.id;if("nazivAsc"==e.value)return a.naziv>i.naziv?1:a.naziv<i.naziv?-1:0;if("nazivDesc"==e.value)return a.naziv>i.naziv?-1:a.naziv<i.naziv?1:0;if("cenaAsc"==e.value)return null!=a.cenaInfo.cenaNova?null!=i.cenaInfo.cenaNova?a.cenaInfo.cenaNova-i.cenaInfo.cenaNova:a.cenaInfo.cenaNova-i.cenaInfo.cenaStara:null!=i.cenaInfo.cenaNova?a.cenaInfo.cenaStara-i.cenaInfo.cenaNova:a.cenaInfo.cenaStara-i.cenaInfo.cenaStara;if("cenaDesc"==e.value)return null!=a.cenaInfo.cenaNova?null!=i.cenaInfo.cenaNova?i.cenaInfo.cenaNova-a.cenaInfo.cenaNova:i.cenaInfo.cenaStara-a.cenaInfo.cenaNova:null!=i.cenaInfo.cenaNova?i.cenaInfo.cenaNova-a.cenaInfo.cenaStara:i.cenaInfo.cenaStara-a.cenaInfo.cenaStara;return"datAsc"==e.value?(dat1=new Date(a.datumIzlaska))-(dat2=new Date(i.datumIzlaska)):"datDesc"==e.value?(dat1=new Date(a.datumIzlaska),(dat2=new Date(i.datumIzlaska))-dat1):void 0})}function filtriranje(a,e){if("pretraga"==e){let i=document.querySelector("#inputNaziv").value.trim().toLowerCase();""!=i&&(a=a.filter(a=>a.naziv.toLowerCase().includes(i)||a.sifra.toLowerCase().includes(i)))}if("chbProizvođači"==e||"chbPegi"==e){let n=[];$(`#${e} input[type=checkbox]:checked`).each(function(a,e){n.push(Number(e.value))}),n.length&&(a="chbPegi"==e?a.filter(a=>n.includes(a.pegiOznaka)):a.filter(a=>n.includes(a.proizvodjac)))}if("chbPlatforme"==e||"chbŽanrovi"==e){let r=[];if($(`#${e} input[type=checkbox]:checked`).each(function(a,e){r.push(Number(e.value))}),r.length>1){let t=(a,e)=>a.length==e.length&&a.every(a=>e.includes(a));"chbPlatforme"==e?a=a.filter(a=>t(r,a.platforme)):e==`chbŽanrovi`&&(a=a.filter(a=>t(r,a.zanrovi)))}else 1==r.length&&("chbPlatforme"==e?a=a.filter(a=>a.platforme.includes(r[0])):e==`chbŽanrovi`&&(a=a.filter(a=>a.zanrovi.includes(r[0]))))}return a}function prikazProizvodaProdavnica(){var a=document.querySelector("#proizvodiBlok"),e=document.querySelector("#brPri"),i=document.querySelector("#brPro");let n=[];n=filtriranje(nizProizvoda,"pretraga"),n=filtriranje(n,"chbProizvođači"),n=filtriranje(n,"chbPlatforme"),n=filtriranje(n,"chbPegi"),(n=sortiranjeProizvoda(n=filtriranje(n,"chbŽanrovi"))).length?(prikaziBrChb(n),prikazProizvoda(n,a),dodavanjeKorpa(),prikaziBrojProizvodaUKorpi()):a.innerHTML='<div class="col-10 mx-auto my-5 py-5 alert alert-warning text-center rounded-3"><p class="fs-2 fw-bold">Nema proizvoda koji ispunjavaju sve parametre !!!</p></div>',e.innerHTML=n.length,i.innerHTML=nizProizvoda.length}function prikaziBrChb(a){for(var e of["Proizvođači","Platforme","Pegi","Žanrovi"])$(`#chb${e} span`).each((i,n)=>{"Proizvođači"==e&&(n.innerHTML=`(${a.filter(a=>a.proizvodjac==$(n).data("id")).length})`),"Platforme"==e&&(n.innerHTML=`(${a.filter(a=>a.platforme.includes($(n).data("id"))).length})`),"Pegi"==e&&(n.innerHTML=`(${a.filter(a=>a.pegiOznaka==$(n).data("id")).length})`),"Žanrovi"==e&&(n.innerHTML=`(${a.filter(a=>a.zanrovi.includes($(n).data("id"))).length})`)})}function prikazCheckBoxova(a){let e="",i=document.querySelector("#chbPart"),n=["Proizvođači","Platforme","Pegi Oznaka","Žanrovi"],r=nizProizvodjaca,t=nizPlatformi,o=nizPegiOznaka,l=nizZanrova;var s=[r,t,o,l];for(var c in s){for(let d of(e+=`<div class="col-lg-12 col-6"><h3 class="my-3 text-center fw-bold">${n[c]}</h3>
        <div id="chb${n[c].split(" ")[0]}">`,s[c]))e+=`<div class="form-check">
                        <input class="form-check-input" type="checkbox" name="chb${n[c].split(" ")[0]}" value="${d.id}" id="chb${n[c].split(" ")[0]}${d.id}" />
                        <label class="form-check-label ms-3" for="chb${n[c].split(" ")[0]}${d.id}">
                        ${d.naziv}<span class="fw-bold ms-2 ${n[c].split(" ")[0]}" data-id="${d.id}">(${a.filter(a=>a.proizvodjac==d).length})</span>
                    </label>
                    </div>`;e+=" </div></div>"}e+=`<button id='cistac' class="btn btn-warning w-100 az-btn-pro rounded-0 my-5 rounded-bottom fs-5" >Očisti filtere <i class="fa-solid fa-x"></i></button>`,i.innerHTML=e}function ocistiFiltere(){document.querySelectorAll("#chbPart input[type='checkbox']").forEach(a=>a.checked=!1),document.querySelector("#inputNaziv").value="",document.querySelector("#sortPro").selectedIndex=0,prikazProizvodaProdavnica()}async function proizovodi(){nizProizvoda=await dohvatiPodatkePromise("proizvodi.json"),nizProizvodjaca=await dohvatiPodatkePromise("proizvodjaci.json"),nizPegiOznaka=await dohvatiPodatkePromise("pegi.json"),nizPlatformi=await dohvatiPodatkePromise("platforme.json"),nizZanrova=await dohvatiPodatkePromise("zanrovi.json"),nizPromocije=await dohvatiPodatkePromise("promocije.json")}function datumPrikaz(a){return`${a.getDate()}.${a.getMonth()+1}.${a.getFullYear()}`}function prikazModalaArtikal(){$(".az-btn-modal").click(function(a){let e=document.querySelector("#proizvodModal");e.querySelector("#trajanjeAkcije").innerHTML="",id=$(a.currentTarget).data("id");let i=nizProizvoda.filter(a=>a.id==id)[0];if(e.querySelector(".modal-header p").innerHTML=nizProizvodjaca.filter(a=>a.id==i.proizvodjac)[0].naziv,e.querySelector(".modal-title").innerHTML=i.naziv,e.querySelector(".modal-body img:nth-child(1)").src=prefiksOnline+i.slika.src,e.querySelector(".modal-body img:nth-child(1)").alt=i.slika.alt,e.querySelector(".modal-body img:nth-child(2)").src=prefiksOnline+nizPegiOznaka.filter(a=>a.id==i.pegiOznaka)[0].slika.src,e.querySelector(".modal-body img:nth-child(2)").alt=nizPegiOznaka.filter(a=>a.id==i.pegiOznaka)[0].slika.alt,e.querySelector(".modal-body p.card-text").innerHTML=`${null!=i.cenaInfo.cenaNova?`<span class="az-old-cena text-warning fw-bold me-2">${i.cenaInfo.cenaStara} RSD</span><span class="az-new-cena fs-4">${i.cenaInfo.cenaNova} RSD</span> `:`<span class="az-new-cena fs-4">${i.cenaInfo.cenaStara} RSD</span>`}`,null!=i.cenaInfo.cenaNova){let n=nizPromocije.filter(a=>a.id==i.cenaInfo.promocija)[0];e.querySelector("#trajanjeAkcije").innerHTML=`<p class="alert alert-info">${n.naziv} na kojoj se nalazi ovaj proizvod traje od ${datumPrikaz(new Date(n.datumPoc))} do ${datumPrikaz(new Date(n.datumKraj))}</p>`}e.querySelector(".modal-footer p small").innerHTML=`${datumPrikaz(new Date(i.datumIzlaska))}`,e.querySelector(".modal-body #zanrovi").innerHTML=nizZanrova.filter(a=>i.zanrovi.includes(a.id)).map(a=>a.naziv).join("/"),e.querySelector(".modal-body #opis").innerHTML=i.opis,e.querySelector(".modal-body #sifra").innerHTML=i.sifra,e.querySelector(".modal-body #platforme").innerHTML=nizPlatformi.filter(a=>i.platforme.includes(a.id)).map(a=>a.naziv).join("/"),crtanjeModala(e)})}function postaviLS(a,e){localStorage.setItem(a,JSON.stringify(e))}function dohvatiLS(a){return JSON.parse(localStorage.getItem(a))}function brArtikalaKorpa(){return null==JSON.parse(localStorage.getItem("korpa"))?0:JSON.parse(localStorage.getItem("korpa")).length}function prikaziBrojProizvodaUKorpi(){document.querySelector(".az-cart-number").innerHTML=brArtikalaKorpa()}function dodavanjeKorpa(){$(".az-btn-korpa").click(function(){upisProizvoda(this.dataset.id)})}function upisProizvoda(a){let e=dohvatiLS("korpa"),i=0;null!=e&&(i=e.filter(e=>e.id==a).length),null!=e?i>0?azurirajKolicinu(a,e):(proizvodDodajKorpa(a,e),prikaziBrojProizvodaUKorpi()):(proizvodDodajKorpa(a,[]),prikaziBrojProizvodaUKorpi()),prikazDodato()}function azurirajKolicinu(a,e){for(el of e)if(el.id==a){el.qty++;break}postaviLS("korpa",e)}function proizvodDodajKorpa(a,e){let i=nizProizvoda.filter(e=>e.id==a)[0];e.push({id:i.id,naziv:i.naziv,cenaInfo:i.cenaInfo,sifra:i.sifra,slika:i.slika,qty:1}),postaviLS("korpa",e)}function prikazDodato(){divObj=document.querySelector("#korpaAlert"),korpaAlert.classList.remove("d-none"),korpaAlert.classList.add("az-opacity"),korpaAlert.classList.remove("az-opac-0"),setTimeout(function(){korpaAlert.classList.remove("az-opacity"),korpaAlert.classList.add("az-opac-0"),setTimeout(()=>korpaAlert.classList.add("d-none"),500)},1300)}function prikazPraznuKorpu(){document.querySelector("#korpaIspis").innerHTML=`<p class="text-center fs-5">Trenutno nema artikala u korpi</p>
    <a href="../pages/proizvodi.html" class="btn btn-warning w-25 mx-auto az-btn-pro">Pogledaj ponudu<i class="fa-solid fa-store ms-2"></i></a>`,prikaziBrojProizvodaUKorpi()}function prikazKorpe(a){let e="";e=`
    <div class="table-responsive-xl">
        <table class="table w-75 mx-auto text-center">
        <thead>
        <tr class="table-dark border-botom">
          <th scope="col" class="az-orange">#</th>
          <th scope="col" class="az-orange">Proizvod</th>
          <th scope="col" class="az-orange">Naziv</th>
          <th scope="col" class="az-orange">Sifra proizvoda</th>
          <th scope="col" class="az-orange">Jedinična cena</th>
          <th scope="col" class="az-orange">Količina</th>
          <th scope="col" class="az-orange">Ukupna cena</th>
          <th scope="col" class="az-orange">Obriši</th>
        </tr>
        </thead>
        <tbody>
        `;let i=0;a.forEach((a,n)=>{e+=prikaziProizvodKorpa(a,n+1),i+=a.qty*cenaProizvoda(a)}),e+=`<tr class="fs-5 fw-bold table-warning">
                <td colspan="5">Ukupna cena svih artikala je :</td>
                <td colspan="3">${i.toLocaleString()} RSD</td>
            </tr>`,document.querySelector("#korpaIspis").innerHTML=`${e}</tbody></table>
    </div>
    ${Number(i)>=3e3?`<div class="alert w-50 bg-warning mx-auto text-center py-2" >
    <p class="fw-bold my-2">Besplatna isporuka <i class="fa-solid fa-truck ms-2 fs-3 az-valign"></i></p>
  </div>`:`<div class="alert w-50 bg-danger mx-auto text-center py-2" >
  <p class="fw-bold my-2 az-white">Isporuka nije besplatna <i class="fa-solid fa-truck ms-2 fs-3 az-valign az-white"></i></p>
</div>`}
    <div class="row w-75 mx-auto my-5">
        <div class="offset-lg-6 col-lg-6 col-12 text-end">
            <button type='button' id="btnPoruci" class="btn-lg az-btn-pro btn-warning fw-bold">Poruči <i class="fa-solid fa-cart-shopping ms-2"></i></button>
            <button type='button' id="btnOtkazi" class="btn-lg az-btn-pro btn-danger">Otkaži</button>
        </div>
    </div>`,$("table .az-btn-pro").click(function(){brisanjeLS($(this).data("id"))}),$("input[type=number]").bind("blur change",function(){Number(this.value)>0&&((pro=dohvatiLS("korpa")).filter(a=>a.id==Number(this.id.substring(8)))[0].qty=this.value,postaviLS("korpa",pro),prikazKorpe(pro)),Number(0==this.value)&&brisanjeLS(this.id.substring(8)),this.value<0&&(this.value=1,prikazKorpe(dohvatiLS("korpa")))}),document.querySelector("#btnOtkazi").addEventListener("click",function(){localStorage.clear(),prikazPraznuKorpu()}),document.querySelector("#btnPoruci").addEventListener("click",prikazModalaPoruci),prikaziBrojProizvodaUKorpi()}function prikaziProizvodKorpa(a,e){let i="",n=dohvatiLS("korpa").filter(e=>e.id==a.id)[0];return`<tr>
        <td class="align-middle">${e}</td>
        <td class='align-middle az-w-15'><img class="img-fluid" alt="${n.slika.alt}" src="${prefiksOnline+n.slika.src}" /></td>
        <td class='align-middle fw-bold fs-4 '>${n.naziv}</td>
        <td class='align-middle fw-bold '>${n.sifra}</td>
        <td class='align-middle fs-6'>${cenaStaraProizvoda(n)?"":`<s class="text-danger">${n.cenaInfo.cenaStara} RSD</s></br>`}${cenaProizvoda(n)} RSD</td>
        <td class='align-middle '><input type="number" class="form-control w-75 mx-auto" min="1" step="1" max="100" name="proizvod${n.id}" id="proizvod${n.id}" value="${n.qty}" /></div></td>
        <td class="align-middle fw-bold fs-4">${n.qty*cenaProizvoda(n)} RSD</td>
        <td class="align-middle"><button type='button' class="btn az-btn-pro btn-warning" data-id="${n.id}">Obrisi</button></td>
        </tr>
    `}function cenaProizvoda(a){return null==a.cenaInfo.cenaNova?a.cenaInfo.cenaStara:a.cenaInfo.cenaNova}function cenaStaraProizvoda(a){return null==a.cenaInfo.cenaNova}function brisanjeLS(a){(igre=dohvatiLS("korpa")).filter(e=>e.id==a)[0].qty=0,(pro=igre.filter(a=>a.qty>0)).length?(postaviLS("korpa",pro),prikazKorpe(pro)):(localStorage.removeItem("korpa"),prikazPraznuKorpu())}function prikazModalaPoruci(){let a=document.querySelector("#poruciModal"),e=new Date;e.setTime(e.getTime()+1728e5),a.querySelector("small").innerHTML=`${datumPrikaz(e)}`,crtanjeModala(a)}